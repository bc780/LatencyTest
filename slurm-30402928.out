
Lmod is automatically replacing "gcc-native/12.3" with "gcc/11.2.0".


Inactive Modules:
  1) cray-libsci/23.12.5

The following have been reloaded with a version change:
  1) cray-mpich/8.1.28 => cray-mpich/8.1.25
  2) cudatoolkit/12.2 => cudatoolkit/11.7

nid[001320,001444,003552-003553]
2024-09-13 09:39:30,123 INFO Initialized rank 4 out of 16
2024-09-13 09:39:30,124 INFO Initialized rank 1 out of 16
2024-09-13 09:39:30,125 INFO Initialized rank 2 out of 16
2024-09-13 09:39:30,125 INFO Initialized rank 3 out of 16
2024-09-13 09:39:30,126 INFO Initialized rank 0 out of 16
2024-09-13 09:39:30,126 INFO Initialized rank 14 out of 16
2024-09-13 09:39:30,126 INFO Initialized rank 6 out of 16
2024-09-13 09:39:30,127 INFO Initialized rank 5 out of 16
2024-09-13 09:39:30,127 INFO Initialized rank 11 out of 16
2024-09-13 09:39:30,127 INFO Initialized rank 9 out of 16
2024-09-13 09:39:30,127 INFO Initialized rank 15 out of 16
2024-09-13 09:39:30,127 INFO Initialized rank 12 out of 16
2024-09-13 09:39:30,128 INFO Initialized rank 13 out of 16
2024-09-13 09:39:30,128 INFO Initialized rank 7 out of 16
2024-09-13 09:39:30,128 INFO Initialized rank 8 out of 16
2024-09-13 09:39:30,129 INFO Initialized rank 10 out of 16
Traceback (most recent call last):
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 86, in <module>
Traceback (most recent call last):
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 86, in <module>
Traceback (most recent call last):
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 86, in <module>
2024-09-13 09:39:33,368 INFO Added key: store_based_barrier_key:2 to store for rank: 8
Traceback (most recent call last):
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 86, in <module>
2024-09-13 09:39:33,368 INFO Added key: store_based_barrier_key:2 to store for rank: 4
2024-09-13 09:39:33,369 INFO Added key: store_based_barrier_key:2 to store for rank: 12
2024-09-13 09:39:33,369 INFO Added key: store_based_barrier_key:2 to store for rank: 9
2024-09-13 09:39:33,368 INFO Added key: store_based_barrier_key:2 to store for rank: 6
2024-09-13 09:39:33,369 INFO Added key: store_based_barrier_key:2 to store for rank: 13
2024-09-13 09:39:33,369 INFO Added key: store_based_barrier_key:2 to store for rank: 10
2024-09-13 09:39:33,369 INFO Added key: store_based_barrier_key:2 to store for rank: 7
2024-09-13 09:39:33,369 INFO Added key: store_based_barrier_key:2 to store for rank: 15
2024-09-13 09:39:33,369 INFO Added key: store_based_barrier_key:2 to store for rank: 11
    main()
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 80, in main
2024-09-13 09:39:33,369 INFO Added key: store_based_barrier_key:2 to store for rank: 5
    main()
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 80, in main
2024-09-13 09:39:33,369 INFO Added key: store_based_barrier_key:2 to store for rank: 14
    run(n_ranks, rank)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 15, in run
    run(n_ranks, rank)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 15, in run
    main()
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 80, in main
    main()
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 80, in main
    time  = intraReduce(tensorSize, device, node)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 59, in intraReduce
    run(n_ranks, rank)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 15, in run
    time  = intraReduce(tensorSize, device, node)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 59, in intraReduce
    run(n_ranks, rank)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 15, in run
    dist.all_reduce(tensor, group = group)
UnboundLocalError: local variable 'group' referenced before assignment
    time  = intraReduce(tensorSize, device, node)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 59, in intraReduce
    dist.all_reduce(tensor, group = group)
UnboundLocalError: local variable 'group' referenced before assignment
    time  = intraReduce(tensorSize, device, node)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 59, in intraReduce
    dist.all_reduce(tensor, group = group)
UnboundLocalError: local variable 'group' referenced before assignment
    dist.all_reduce(tensor, group = group)
UnboundLocalError: local variable 'group' referenced before assignment
Traceback (most recent call last):
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 86, in <module>
Traceback (most recent call last):
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 86, in <module>
Traceback (most recent call last):
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 86, in <module>
Traceback (most recent call last):
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 86, in <module>
    main()
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 80, in main
    main()
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 80, in main
    main()
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 80, in main
    main()
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 80, in main
    run(n_ranks, rank)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 15, in run
    run(n_ranks, rank)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 15, in run
    run(n_ranks, rank)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 15, in run
    run(n_ranks, rank)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 15, in run
    time  = intraReduce(tensorSize, device, node)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 50, in intraReduce
    time  = intraReduce(tensorSize, device, node)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 50, in intraReduce
    time  = intraReduce(tensorSize, device, node)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 50, in intraReduce
    time  = intraReduce(tensorSize, device, node)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 50, in intraReduce
    group = dist.new_group([i*4, i*4+1,i*4+2,i*4+3])
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3544, in new_group
    group = dist.new_group([i*4, i*4+1,i*4+2,i*4+3])
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3544, in new_group
    group = dist.new_group([i*4, i*4+1,i*4+2,i*4+3])
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3544, in new_group
    group = dist.new_group([i*4, i*4+1,i*4+2,i*4+3])
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3544, in new_group
    _store_based_barrier(global_rank, default_store, timeout)
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 456, in _store_based_barrier
    _store_based_barrier(global_rank, default_store, timeout)
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 456, in _store_based_barrier
    _store_based_barrier(global_rank, default_store, timeout)
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 456, in _store_based_barrier
    _store_based_barrier(global_rank, default_store, timeout)
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 456, in _store_based_barrier
    worker_count = store.add(store_key, 0)
RuntimeError: Connection reset by peer
    worker_count = store.add(store_key, 0)
    worker_count = store.add(store_key, 0)
RuntimeError: Connection reset by peer
RuntimeError: Connection reset by peer
    worker_count = store.add(store_key, 0)
RuntimeError: Connection reset by peer
Traceback (most recent call last):
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 86, in <module>
Traceback (most recent call last):
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 86, in <module>
Traceback (most recent call last):
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 86, in <module>
Traceback (most recent call last):
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 86, in <module>
    main()
    main()
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 80, in main
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 80, in main
Traceback (most recent call last):
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 86, in <module>
    main()
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 80, in main
Traceback (most recent call last):
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 86, in <module>
    main()
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 80, in main
Traceback (most recent call last):
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 86, in <module>
Traceback (most recent call last):
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 86, in <module>
    run(n_ranks, rank)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 15, in run
    run(n_ranks, rank)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 15, in run
    run(n_ranks, rank)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 15, in run
    run(n_ranks, rank)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 15, in run
    time  = intraReduce(tensorSize, device, node)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 50, in intraReduce
    time  = intraReduce(tensorSize, device, node)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 50, in intraReduce
    time  = intraReduce(tensorSize, device, node)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 50, in intraReduce
    main()
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 80, in main
    main()
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 80, in main
    main()
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 80, in main
    time  = intraReduce(tensorSize, device, node)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 50, in intraReduce
    main()
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 80, in main
    group = dist.new_group([i*4, i*4+1,i*4+2,i*4+3])
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3544, in new_group
    group = dist.new_group([i*4, i*4+1,i*4+2,i*4+3])
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3544, in new_group
    _store_based_barrier(global_rank, default_store, timeout)
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 456, in _store_based_barrier
    _store_based_barrier(global_rank, default_store, timeout)
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 456, in _store_based_barrier
    worker_count = store.add(store_key, 0)
RuntimeError: Connection reset by peer
    worker_count = store.add(store_key, 0)
RuntimeError: Connection reset by peer
    group = dist.new_group([i*4, i*4+1,i*4+2,i*4+3])
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3544, in new_group
    _store_based_barrier(global_rank, default_store, timeout)
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 456, in _store_based_barrier
    worker_count = store.add(store_key, 0)
RuntimeError: Connection reset by peer
    run(n_ranks, rank)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 15, in run
    run(n_ranks, rank)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 15, in run
    run(n_ranks, rank)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 15, in run
    time  = intraReduce(tensorSize, device, node)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 50, in intraReduce
    time  = intraReduce(tensorSize, device, node)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 50, in intraReduce
    time  = intraReduce(tensorSize, device, node)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 50, in intraReduce
    group = dist.new_group([i*4, i*4+1,i*4+2,i*4+3])
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3544, in new_group
    group = dist.new_group([i*4, i*4+1,i*4+2,i*4+3])
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3544, in new_group
    group = dist.new_group([i*4, i*4+1,i*4+2,i*4+3])
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3544, in new_group
    _store_based_barrier(global_rank, default_store, timeout)
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 456, in _store_based_barrier
    _store_based_barrier(global_rank, default_store, timeout)
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 456, in _store_based_barrier
    _store_based_barrier(global_rank, default_store, timeout)
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 456, in _store_based_barrier
    worker_count = store.add(store_key, 0)
RuntimeError: Connection reset by peer
    worker_count = store.add(store_key, 0)
RuntimeError: Connection reset by peer
    worker_count = store.add(store_key, 0)
RuntimeError: Connection reset by peer
    run(n_ranks, rank)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 15, in run
    group = dist.new_group([i*4, i*4+1,i*4+2,i*4+3])
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3544, in new_group
    _store_based_barrier(global_rank, default_store, timeout)
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 456, in _store_based_barrier
    time  = intraReduce(tensorSize, device, node)
  File "/global/u1/b/bchan728/BandwidthTest/allReduceTest.py", line 50, in intraReduce
    worker_count = store.add(store_key, 0)
RuntimeError: Connection reset by peer
    group = dist.new_group([i*4, i*4+1,i*4+2,i*4+3])
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3544, in new_group
    _store_based_barrier(global_rank, default_store, timeout)
  File "/global/common/software/nersc/pm-2022q4/sw/pytorch/2.0.1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 456, in _store_based_barrier
    worker_count = store.add(store_key, 0)
RuntimeError: Connection reset by peer
srun: error: nid001320: task 0: Exited with exit code 1
srun: Terminating StepId=30402928.0
slurmstepd: error: *** STEP 30402928.0 ON nid001320 CANCELLED AT 2024-09-13T16:39:34 ***
srun: error: nid001320: task 2: Exited with exit code 1
srun: error: nid003552: task 11: Exited with exit code 1
srun: error: nid001444: task 5: Exited with exit code 1
srun: error: nid003552: task 10: Exited with exit code 1
srun: error: nid001320: tasks 1,3: Exited with exit code 1
srun: error: nid003553: task 12: Exited with exit code 1
srun: error: nid001444: task 4: Exited with exit code 1
srun: error: nid003552: task 8: Exited with exit code 1
srun: error: nid003553: tasks 13-14: Exited with exit code 1
srun: error: nid003552: task 9: Exited with exit code 1
srun: error: nid003553: task 15: Exited with exit code 1
srun: error: nid001444: tasks 6-7: Exited with exit code 1
BREAK
